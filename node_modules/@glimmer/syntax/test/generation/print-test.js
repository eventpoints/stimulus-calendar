'use strict';

var _syntax = require('@glimmer/syntax');

const { test } = QUnit;
let templates = ['<h1></h1>', '<h1 class="foo" id="title"></h1>', '<h1>Test</h1>', '<h1>{{model.title}}</h1>', '<h1>{{link-to "Foo" class="bar"}}</h1>', '<h1 class={{if foo "foo" "bar"}}>Test</h1>', '<h1 class={{color}}>Test</h1>', '<h1 class="{{if active "active" "inactive"}} foo">Test</h1>', '<p {{action "activate"}} {{someting foo="bar"}}>Test</p>', '<p>{{my-component submit=(action (mut model.name) (full-name model.firstName "Smith"))}}</p>', '<ul>{{#each foos as |foo index|}}\n  <li>{{foo}}: {{index}}</li>\n{{/each}}</ul>', '{{#if foo}}<p>{{foo}}</p>{{/if}}', '{{#if foo}}Foo{{else if bar}}Bar{{else}}Baz{{/if}}', '<Foo>{{bar}}</Foo>', '<Foo></Foo>', '<Foo />', '<Foo as |bar|>{{bar}}</Foo>', '<input disabled />',
// void elements
'<br>', '<br />',
// comments
'<!-- foo -->', '<div {{!-- foo --}}></div>', '<div>{{!-- foo bar --}}<b></b></div>', '{{!-- {{foo-bar}} --}}',
// literals
'<Panel @arg={{"Foo"}}></Panel>', '<Panel @arg={{true}}></Panel>', '<Panel @arg={{5}}></Panel>', '{{panel arg="Foo"}}', '{{panel arg=true}}', '{{panel arg=5}}',
// nested tags with indent
'<div>\n  <p>Test</p>\n</div>',
// attributes escaping
'<h1 class="foo" id="title" data-a="&quot;Foo&nbsp;&amp;&nbsp;Bar&quot;"></h1>', '<h1 class="< &nbsp; {{if x "&" "<"}} &amp; &quot;">Test</h1>',
// slash in path
'{{namespace/foo "bar" baz="qux"}}',
// unescaped
'{{{unescaped}}}'];
QUnit.module('[glimmer-syntax] Code generation', function () {
    function printTransform(template) {
        return (0, _syntax.print)((0, _syntax.preprocess)(template));
    }
    templates.forEach(template => {
        test(`${template} is stable when printed`, function (assert) {
            assert.equal(printTransform(template), template);
        });
    });
    test('TextNode: chars escape - but do not match', assert => {
        assert.equal(printTransform('&lt; &amp; &nbsp; &gt; &copy;2018'), '&lt; &amp; &nbsp; &gt; Â©2018');
    });
    test('Handlebars comment', assert => {
        assert.equal(printTransform('{{! foo }}'), '{{!-- foo --}}');
    });
});
QUnit.module('[glimmer-syntax] Code generation - source -> source', function () {
    function printTransform(template) {
        let ast = (0, _syntax.preprocess)(template, {
            mode: 'codemod',
            parseOptions: { ignoreStandalone: true }
        });
        return (0, _syntax.print)(ast, { entityEncoding: 'raw' });
    }
    function buildTest(template) {
        test(`${template} is stable when printed`, function (assert) {
            assert.equal(printTransform(template), template);
        });
    }
    templates.forEach(buildTest);
    ['&lt; &amp; &nbsp; &gt; &copy;2018',
    // newlines after opening block
    '{{#each}}\n  <li> foo </li>\n{{/each}}'].forEach(buildTest);
    test('whitespace control is preserved', function (assert) {
        let before = '\n{{~var~}}  ';
        let after = '{{~var~}}';
        assert.equal(printTransform(before), after);
    });
    test('block whitespace control is preserved', function (assert) {
        let before = '\n{{~#foo-bar~}} {{~else if x~}} {{~else~}} {{~/foo-bar~}}  ';
        let after = '{{~#foo-bar~}}{{~else if x~}}{{~else~}}{{~/foo-bar~}}';
        assert.equal(printTransform(before), after);
    });
});
QUnit.module('[glimmer-syntax] Code generation - override', function () {
    test('can provide a custom options.override to be used', function (assert) {
        let ast = (0, _syntax.preprocess)(`<FooBar @baz="qux" @derp="qux" />`);
        let actual = (0, _syntax.print)(ast, {
            entityEncoding: 'transformed',
            override(ast) {
                if (ast.type === 'AttrNode' && ast.name === '@baz') {
                    return '@baz="ZOMG!!!!"';
                }
                return;
            }
        });
        assert.equal(actual, `<FooBar @baz="ZOMG!!!!" @derp="qux" />`);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL0BnbGltbWVyL3N5bnRheC90ZXN0L2dlbmVyYXRpb24vcHJpbnQtdGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBRUEsTUFBTSxFQUFFLElBQUYsS0FBVyxLQUFqQjtBQUVBLElBQUksWUFBWSxDQUNkLFdBRGMsRUFFZCxrQ0FGYyxFQUdkLGVBSGMsRUFJZCwwQkFKYyxFQUtkLHdDQUxjLEVBTWQsNENBTmMsRUFPZCwrQkFQYyxFQVFkLDZEQVJjLEVBU2QsMERBVGMsRUFVZCw4RkFWYyxFQVdkLGtGQVhjLEVBWWQsa0NBWmMsRUFhZCxvREFiYyxFQWNkLG9CQWRjLEVBZWQsYUFmYyxFQWdCZCxTQWhCYyxFQWlCZCw2QkFqQmMsRUFtQmQsb0JBbkJjO0FBcUJkO0FBQ0EsTUF0QmMsRUF1QmQsUUF2QmM7QUF5QmQ7QUFDQSxjQTFCYyxFQTJCZCw0QkEzQmMsRUE0QmQsc0NBNUJjLEVBNkJkLHdCQTdCYztBQStCZDtBQUNBLGdDQWhDYyxFQWlDZCwrQkFqQ2MsRUFrQ2QsNEJBbENjLEVBbUNkLHFCQW5DYyxFQW9DZCxvQkFwQ2MsRUFxQ2QsaUJBckNjO0FBdUNkO0FBQ0EsOEJBeENjO0FBMENkO0FBQ0EsK0VBM0NjLEVBNENkLDhEQTVDYztBQThDZDtBQUNBLG1DQS9DYztBQWlEZDtBQUNBLGlCQWxEYyxDQUFoQjtBQXFEQSxNQUFNLE1BQU4sQ0FBYSxrQ0FBYixFQUFpRCxZQUFBO0FBQy9DLGFBQVMsY0FBVCxDQUF3QixRQUF4QixFQUF3QztBQUN0QyxlQUFPLG1CQUFNLHdCQUFNLFFBQU4sQ0FBTixDQUFQO0FBQ0Q7QUFFRCxjQUFVLE9BQVYsQ0FBa0IsWUFBVztBQUMzQixhQUFLLEdBQUcsUUFBUSx5QkFBaEIsRUFBMkMsVUFBUyxNQUFULEVBQWU7QUFDeEQsbUJBQU8sS0FBUCxDQUFhLGVBQWUsUUFBZixDQUFiLEVBQXVDLFFBQXZDO0FBQ0QsU0FGRDtBQUdELEtBSkQ7QUFNQSxTQUFLLDJDQUFMLEVBQWtELFVBQVM7QUFDekQsZUFBTyxLQUFQLENBQ0UsZUFBZSxtQ0FBZixDQURGLEVBRUUsOEJBRkY7QUFJRCxLQUxEO0FBT0EsU0FBSyxvQkFBTCxFQUEyQixVQUFTO0FBQ2xDLGVBQU8sS0FBUCxDQUFhLGVBQWUsWUFBZixDQUFiLEVBQTJDLGdCQUEzQztBQUNELEtBRkQ7QUFHRCxDQXJCRDtBQXVCQSxNQUFNLE1BQU4sQ0FBYSxxREFBYixFQUFvRSxZQUFBO0FBQ2xFLGFBQVMsY0FBVCxDQUF3QixRQUF4QixFQUF3QztBQUN0QyxZQUFJLE1BQU0sd0JBQU0sUUFBTixFQUFnQjtBQUN4QixrQkFBTSxTQURrQjtBQUV4QiwwQkFBYyxFQUFFLGtCQUFrQixJQUFwQjtBQUZVLFNBQWhCLENBQVY7QUFLQSxlQUFPLG1CQUFNLEdBQU4sRUFBVyxFQUFFLGdCQUFnQixLQUFsQixFQUFYLENBQVA7QUFDRDtBQUVELGFBQVMsU0FBVCxDQUFtQixRQUFuQixFQUFtQztBQUNqQyxhQUFLLEdBQUcsUUFBUSx5QkFBaEIsRUFBMkMsVUFBUyxNQUFULEVBQWU7QUFDeEQsbUJBQU8sS0FBUCxDQUFhLGVBQWUsUUFBZixDQUFiLEVBQXVDLFFBQXZDO0FBQ0QsU0FGRDtBQUdEO0FBRUQsY0FBVSxPQUFWLENBQWtCLFNBQWxCO0FBRUEsS0FDRSxtQ0FERjtBQUdFO0FBQ0EsNENBSkYsRUFLRSxPQUxGLENBS1UsU0FMVjtBQU9BLFNBQUssaUNBQUwsRUFBd0MsVUFBUyxNQUFULEVBQWU7QUFDckQsWUFBSSxTQUFTLGVBQWI7QUFDQSxZQUFJLFFBQVEsV0FBWjtBQUVBLGVBQU8sS0FBUCxDQUFhLGVBQWUsTUFBZixDQUFiLEVBQXFDLEtBQXJDO0FBQ0QsS0FMRDtBQU9BLFNBQUssdUNBQUwsRUFBOEMsVUFBUyxNQUFULEVBQWU7QUFDM0QsWUFBSSxTQUFTLDhEQUFiO0FBQ0EsWUFBSSxRQUFRLHVEQUFaO0FBRUEsZUFBTyxLQUFQLENBQWEsZUFBZSxNQUFmLENBQWIsRUFBcUMsS0FBckM7QUFDRCxLQUxEO0FBTUQsQ0F0Q0Q7QUF3Q0EsTUFBTSxNQUFOLENBQWEsNkNBQWIsRUFBNEQsWUFBQTtBQUMxRCxTQUFLLGtEQUFMLEVBQXlELFVBQVMsTUFBVCxFQUFlO0FBQ3RFLFlBQUksTUFBTSx3QkFBTSxtQ0FBTixDQUFWO0FBRUEsWUFBSSxTQUFTLG1CQUFNLEdBQU4sRUFBVztBQUN0Qiw0QkFBZ0IsYUFETTtBQUd0QixxQkFBUyxHQUFULEVBQVk7QUFDVixvQkFBSSxJQUFJLElBQUosS0FBYSxVQUFiLElBQTJCLElBQUksSUFBSixLQUFhLE1BQTVDLEVBQW9EO0FBQ2xELDJCQUFPLGlCQUFQO0FBQ0Q7QUFFRDtBQUNEO0FBVHFCLFNBQVgsQ0FBYjtBQVlBLGVBQU8sS0FBUCxDQUFhLE1BQWIsRUFBcUIsd0NBQXJCO0FBQ0QsS0FoQkQ7QUFpQkQsQ0FsQkQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmVwcm9jZXNzIGFzIHBhcnNlLCBwcmludCB9IGZyb20gJ0BnbGltbWVyL3N5bnRheCc7XG5cbmNvbnN0IHsgdGVzdCB9ID0gUVVuaXQ7XG5cbmxldCB0ZW1wbGF0ZXMgPSBbXG4gICc8aDE+PC9oMT4nLFxuICAnPGgxIGNsYXNzPVwiZm9vXCIgaWQ9XCJ0aXRsZVwiPjwvaDE+JyxcbiAgJzxoMT5UZXN0PC9oMT4nLFxuICAnPGgxPnt7bW9kZWwudGl0bGV9fTwvaDE+JyxcbiAgJzxoMT57e2xpbmstdG8gXCJGb29cIiBjbGFzcz1cImJhclwifX08L2gxPicsXG4gICc8aDEgY2xhc3M9e3tpZiBmb28gXCJmb29cIiBcImJhclwifX0+VGVzdDwvaDE+JyxcbiAgJzxoMSBjbGFzcz17e2NvbG9yfX0+VGVzdDwvaDE+JyxcbiAgJzxoMSBjbGFzcz1cInt7aWYgYWN0aXZlIFwiYWN0aXZlXCIgXCJpbmFjdGl2ZVwifX0gZm9vXCI+VGVzdDwvaDE+JyxcbiAgJzxwIHt7YWN0aW9uIFwiYWN0aXZhdGVcIn19IHt7c29tZXRpbmcgZm9vPVwiYmFyXCJ9fT5UZXN0PC9wPicsXG4gICc8cD57e215LWNvbXBvbmVudCBzdWJtaXQ9KGFjdGlvbiAobXV0IG1vZGVsLm5hbWUpIChmdWxsLW5hbWUgbW9kZWwuZmlyc3ROYW1lIFwiU21pdGhcIikpfX08L3A+JyxcbiAgJzx1bD57eyNlYWNoIGZvb3MgYXMgfGZvbyBpbmRleHx9fVxcbiAgPGxpPnt7Zm9vfX06IHt7aW5kZXh9fTwvbGk+XFxue3svZWFjaH19PC91bD4nLFxuICAne3sjaWYgZm9vfX08cD57e2Zvb319PC9wPnt7L2lmfX0nLFxuICAne3sjaWYgZm9vfX1Gb297e2Vsc2UgaWYgYmFyfX1CYXJ7e2Vsc2V9fUJhent7L2lmfX0nLFxuICAnPEZvbz57e2Jhcn19PC9Gb28+JyxcbiAgJzxGb28+PC9Gb28+JyxcbiAgJzxGb28gLz4nLFxuICAnPEZvbyBhcyB8YmFyfD57e2Jhcn19PC9Gb28+JyxcblxuICAnPGlucHV0IGRpc2FibGVkIC8+JyxcblxuICAvLyB2b2lkIGVsZW1lbnRzXG4gICc8YnI+JyxcbiAgJzxiciAvPicsXG5cbiAgLy8gY29tbWVudHNcbiAgJzwhLS0gZm9vIC0tPicsXG4gICc8ZGl2IHt7IS0tIGZvbyAtLX19PjwvZGl2PicsXG4gICc8ZGl2Pnt7IS0tIGZvbyBiYXIgLS19fTxiPjwvYj48L2Rpdj4nLFxuICAne3shLS0ge3tmb28tYmFyfX0gLS19fScsXG5cbiAgLy8gbGl0ZXJhbHNcbiAgJzxQYW5lbCBAYXJnPXt7XCJGb29cIn19PjwvUGFuZWw+JyxcbiAgJzxQYW5lbCBAYXJnPXt7dHJ1ZX19PjwvUGFuZWw+JyxcbiAgJzxQYW5lbCBAYXJnPXt7NX19PjwvUGFuZWw+JyxcbiAgJ3t7cGFuZWwgYXJnPVwiRm9vXCJ9fScsXG4gICd7e3BhbmVsIGFyZz10cnVlfX0nLFxuICAne3twYW5lbCBhcmc9NX19JyxcblxuICAvLyBuZXN0ZWQgdGFncyB3aXRoIGluZGVudFxuICAnPGRpdj5cXG4gIDxwPlRlc3Q8L3A+XFxuPC9kaXY+JyxcblxuICAvLyBhdHRyaWJ1dGVzIGVzY2FwaW5nXG4gICc8aDEgY2xhc3M9XCJmb29cIiBpZD1cInRpdGxlXCIgZGF0YS1hPVwiJnF1b3Q7Rm9vJm5ic3A7JmFtcDsmbmJzcDtCYXImcXVvdDtcIj48L2gxPicsXG4gICc8aDEgY2xhc3M9XCI8ICZuYnNwOyB7e2lmIHggXCImXCIgXCI8XCJ9fSAmYW1wOyAmcXVvdDtcIj5UZXN0PC9oMT4nLFxuXG4gIC8vIHNsYXNoIGluIHBhdGhcbiAgJ3t7bmFtZXNwYWNlL2ZvbyBcImJhclwiIGJhej1cInF1eFwifX0nLFxuXG4gIC8vIHVuZXNjYXBlZFxuICAne3t7dW5lc2NhcGVkfX19Jyxcbl07XG5cblFVbml0Lm1vZHVsZSgnW2dsaW1tZXItc3ludGF4XSBDb2RlIGdlbmVyYXRpb24nLCBmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gcHJpbnRUcmFuc2Zvcm0odGVtcGxhdGU6IHN0cmluZykge1xuICAgIHJldHVybiBwcmludChwYXJzZSh0ZW1wbGF0ZSkpO1xuICB9XG5cbiAgdGVtcGxhdGVzLmZvckVhY2godGVtcGxhdGUgPT4ge1xuICAgIHRlc3QoYCR7dGVtcGxhdGV9IGlzIHN0YWJsZSB3aGVuIHByaW50ZWRgLCBmdW5jdGlvbihhc3NlcnQpIHtcbiAgICAgIGFzc2VydC5lcXVhbChwcmludFRyYW5zZm9ybSh0ZW1wbGF0ZSksIHRlbXBsYXRlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnVGV4dE5vZGU6IGNoYXJzIGVzY2FwZSAtIGJ1dCBkbyBub3QgbWF0Y2gnLCBhc3NlcnQgPT4ge1xuICAgIGFzc2VydC5lcXVhbChcbiAgICAgIHByaW50VHJhbnNmb3JtKCcmbHQ7ICZhbXA7ICZuYnNwOyAmZ3Q7ICZjb3B5OzIwMTgnKSxcbiAgICAgICcmbHQ7ICZhbXA7ICZuYnNwOyAmZ3Q7IMKpMjAxOCdcbiAgICApO1xuICB9KTtcblxuICB0ZXN0KCdIYW5kbGViYXJzIGNvbW1lbnQnLCBhc3NlcnQgPT4ge1xuICAgIGFzc2VydC5lcXVhbChwcmludFRyYW5zZm9ybSgne3shIGZvbyB9fScpLCAne3shLS0gZm9vIC0tfX0nKTtcbiAgfSk7XG59KTtcblxuUVVuaXQubW9kdWxlKCdbZ2xpbW1lci1zeW50YXhdIENvZGUgZ2VuZXJhdGlvbiAtIHNvdXJjZSAtPiBzb3VyY2UnLCBmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gcHJpbnRUcmFuc2Zvcm0odGVtcGxhdGU6IHN0cmluZykge1xuICAgIGxldCBhc3QgPSBwYXJzZSh0ZW1wbGF0ZSwge1xuICAgICAgbW9kZTogJ2NvZGVtb2QnLFxuICAgICAgcGFyc2VPcHRpb25zOiB7IGlnbm9yZVN0YW5kYWxvbmU6IHRydWUgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiBwcmludChhc3QsIHsgZW50aXR5RW5jb2Rpbmc6ICdyYXcnIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gYnVpbGRUZXN0KHRlbXBsYXRlOiBzdHJpbmcpIHtcbiAgICB0ZXN0KGAke3RlbXBsYXRlfSBpcyBzdGFibGUgd2hlbiBwcmludGVkYCwgZnVuY3Rpb24oYXNzZXJ0KSB7XG4gICAgICBhc3NlcnQuZXF1YWwocHJpbnRUcmFuc2Zvcm0odGVtcGxhdGUpLCB0ZW1wbGF0ZSk7XG4gICAgfSk7XG4gIH1cblxuICB0ZW1wbGF0ZXMuZm9yRWFjaChidWlsZFRlc3QpO1xuXG4gIFtcbiAgICAnJmx0OyAmYW1wOyAmbmJzcDsgJmd0OyAmY29weTsyMDE4JyxcblxuICAgIC8vIG5ld2xpbmVzIGFmdGVyIG9wZW5pbmcgYmxvY2tcbiAgICAne3sjZWFjaH19XFxuICA8bGk+IGZvbyA8L2xpPlxcbnt7L2VhY2h9fScsXG4gIF0uZm9yRWFjaChidWlsZFRlc3QpO1xuXG4gIHRlc3QoJ3doaXRlc3BhY2UgY29udHJvbCBpcyBwcmVzZXJ2ZWQnLCBmdW5jdGlvbihhc3NlcnQpIHtcbiAgICBsZXQgYmVmb3JlID0gJ1xcbnt7fnZhcn59fSAgJztcbiAgICBsZXQgYWZ0ZXIgPSAne3t+dmFyfn19JztcblxuICAgIGFzc2VydC5lcXVhbChwcmludFRyYW5zZm9ybShiZWZvcmUpLCBhZnRlcik7XG4gIH0pO1xuXG4gIHRlc3QoJ2Jsb2NrIHdoaXRlc3BhY2UgY29udHJvbCBpcyBwcmVzZXJ2ZWQnLCBmdW5jdGlvbihhc3NlcnQpIHtcbiAgICBsZXQgYmVmb3JlID0gJ1xcbnt7fiNmb28tYmFyfn19IHt7fmVsc2UgaWYgeH59fSB7e35lbHNlfn19IHt7fi9mb28tYmFyfn19ICAnO1xuICAgIGxldCBhZnRlciA9ICd7e34jZm9vLWJhcn59fXt7fmVsc2UgaWYgeH59fXt7fmVsc2V+fX17e34vZm9vLWJhcn59fSc7XG5cbiAgICBhc3NlcnQuZXF1YWwocHJpbnRUcmFuc2Zvcm0oYmVmb3JlKSwgYWZ0ZXIpO1xuICB9KTtcbn0pO1xuXG5RVW5pdC5tb2R1bGUoJ1tnbGltbWVyLXN5bnRheF0gQ29kZSBnZW5lcmF0aW9uIC0gb3ZlcnJpZGUnLCBmdW5jdGlvbigpIHtcbiAgdGVzdCgnY2FuIHByb3ZpZGUgYSBjdXN0b20gb3B0aW9ucy5vdmVycmlkZSB0byBiZSB1c2VkJywgZnVuY3Rpb24oYXNzZXJ0KSB7XG4gICAgbGV0IGFzdCA9IHBhcnNlKGA8Rm9vQmFyIEBiYXo9XCJxdXhcIiBAZGVycD1cInF1eFwiIC8+YCk7XG5cbiAgICBsZXQgYWN0dWFsID0gcHJpbnQoYXN0LCB7XG4gICAgICBlbnRpdHlFbmNvZGluZzogJ3RyYW5zZm9ybWVkJyxcblxuICAgICAgb3ZlcnJpZGUoYXN0KSB7XG4gICAgICAgIGlmIChhc3QudHlwZSA9PT0gJ0F0dHJOb2RlJyAmJiBhc3QubmFtZSA9PT0gJ0BiYXonKSB7XG4gICAgICAgICAgcmV0dXJuICdAYmF6PVwiWk9NRyEhISFcIic7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm47XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgYXNzZXJ0LmVxdWFsKGFjdHVhbCwgYDxGb29CYXIgQGJhej1cIlpPTUchISEhXCIgQGRlcnA9XCJxdXhcIiAvPmApO1xuICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==